\documentclass{article}
\usepackage{mathtools}
\usepackage{harpoon}
\usepackage{amsfonts}

\makeatletter
\newcommand{\tpmod}[1]{{\@displayfalse\pmod{#1}}}
\makeatother

\begin{document}
\title{Introduction to Modern Cryptography - EX. 4}
\author{Roi Koren 305428369\\ Noam Koren 204175004}
\date{\today}
\pagenumbering{gobble}
\maketitle
\newpage
\pagenumbering{roman}

\section{Rabin's signatures}
\begin{paragraph}
    b The signer calculates $f(x) = x^{\frac{(p-1)(q-1)}{2}}$ and returns $x \in QR_n \\\iff f(x) = 1$.
\end{paragraph}

\begin{paragraph}
    c First we note that -
    \begin{equation*}
        p \equiv 3 \tpmod 8 \Rightarrow p \equiv 3 \tpmod 4
    \end{equation*}
    and that -
    \begin{equation*}
        q \equiv 7 \tpmod 8 \Rightarrow q \equiv 3 \tpmod 4  
    \end{equation*}
    As we've seen, we can then calculate - $x_p = \pm l^{\frac{p+1}{4}}$, 
    $x_q = \pm l^{\frac{q+1}{4}}$. The square roots are $(x_p, x_q), (-x_p, x_q), 
    (x_p, -x_q), (-x_p, -x_q)$.
\end{paragraph}

\begin{paragraph}
    d The verifier receives $(m, \sqrt{l})$. He then calculates $l$ and accepts if
    it is equal to any of $m, -m, 2m, -2m$.
\end{paragraph}

\begin{paragraph}
    e We'll split for 2 cases. {\bf1)} $l = \pm m$. Clearly, the same signature holds for the 4 messages $m, -m, \frac{1}{2}m, -\frac{1}{2}m$. 
    {\bf2)} $l = \pm 2m$. Clearly, the same signature holds for the 4 messages $m, -m, 2m, -2m$.
\end{paragraph}

\begin{paragraph}
    f If $m \in (\frac{n}{8}, \frac{n}{4})$ the other possible messages which may have
    the same signature belong to the following intervals - 
    $2m \in (\frac{n}{4}, \frac{n}{2})$, $-2m \in (\frac{n}{2}, \frac{3n}{4})$,
    $-m \in (\frac{3n}{4}, \frac{7n}{8})$, $\frac{m}{2} \in (\frac{n}{16}, \frac{n}{8})$,
    $\frac{m}{2} \in (\frac{7n}{8}, \frac{15n}{16})$. Notice all of the intervals are pairwise disjoint.
    The verification process can now include a check whether the received message $m$,
    is in the appropriate interval.
\end{paragraph}

\begin{paragraph}
    g The scheme is not secured under such a notion. An attacker can request two legal pairs - 
    $(m_1, \sqrt{l_1}), (m_2, \sqrt{l_2})$. He can then build a new message $m = l_1 \cdot l_2$,
    whose signature is $Sign(m) = \sqrt{l_1 \cdot \l_2} = \sqrt{l_1}\cdot \sqrt{l_2}$.
    Notice that $l_1, l_2 \in QR_n \Rightarrow l_1 \cdot l_2 \in QR_n$ meaning the given signature
    is indeed a valid signature.
\end{paragraph}

\begin{paragraph}
    h In order to build a secure signature scheme we assume we have a random oracle $\mathcal{H}$.
    The signature scheme would be $\sigma(m) = \sqrt{\mathcal{H}(m)}$.
    Assume towards a contradiction that there exists an adversary $\mathcal{A}$ of complexity $(t, \varepsilon)$,
    that can query $\mathcal{H}$ and the signer and is able to forge a valid signature. We'll build an adversary
    $\mathcal{B}$ that is able of factoring. When $\mathcal{A}$ requests queries from $\mathcal{H}$, if that value was
    previously requested, respond as before, else, choose a random value $x \in (\frac{n}{8}, \frac{n}{4})$,
    save the result and return $x^2$. When $\mathcal{A}$ requests a signature for $m$, if that value was
    previously requested, respond as before, else, choose a random value $x \in (\frac{n}{8}, \frac{n}{4})$,
    save the result and return $x$. \\
    After $t$ queries, $\mathcal{A}$ will return a legal message-signature pair, $(m, \sigma)$ with probability $\varepsilon$.
    Since when $\mathcal{A}$ requested $\mathcal{H}$, we returned $x^2 \Rightarrow \sigma = \sqrt{(x^2)}$. This
    combined with $x$ which we saved gives us two roots of $x^2$, which we can use to factorize
    $\mathcal{H}(m)$ w.p $\frac{1}{2}$. Hence, forging a signature is as hard as factoring.
\end{paragraph}

\section{Schnorr signature}
\quad a 

\section{RSA signatures via CRT}
\begin{paragraph}
    a Given an error calculating $S_q$, gives $S_q' = S_q + \varepsilon$, one gets the following
    corrupted signature - $S' = q\cdot inv(q, p)\cdot S_p + p\cdot inv(p,q)\cdot S_q' =
    S + p\cdot inv(p,q)\cdot \varepsilon$, where $S$ is the correct signature. Given both $S, S'$,
    one can calculate their difference - $S' - S = p\cdot \varepsilon\cdot inv(p,q) \Rightarrow p|S'-S$.
    Using $gcd(S' - S, N)$ we can find $p$.
\end{paragraph}

\begin{paragraph}
    b TODO
\end{paragraph}

\section{Commitments}
\quad a

\section{ZK and Commitments}
\begin{paragraph}
    a Bob will accept with $\Pr = 1$. Since $N \in L$, $y$ has exactly four square roots, which
    Alice can find efficiently, given that she knows $p,q$ s.t. $N = p\cdot q$, one
    of which most be the one sampled by Bob, meaning Bob will receive a list which follows
    the protocol.
\end{paragraph}

\begin{paragraph}
    b As we've seen in class $\mathbb{Z}^*_{pqr} \cong \mathbb{Z}^*_p \times \mathbb{Z}^*_q \times \mathbb{Z}^*_r$.
    This means that any number $y$ from the group will have 8 square roots.
    Bob will accept only if $x$ is one of the roots that Alice chooses. Since Alice can't
    know which is the root chosen by Bob, she can only guess 4 random roots.
    The probability that $x$ is among those roots is $\frac{4}{8} = \frac{1}{2}$, hence
    Bob accepts with $\Pr = \frac{1}{2}$.
\end{paragraph}

\begin{paragraph}
    c The protocol isn't sound {\bf TODO}
\end{paragraph}

\section{Fun with secret sharing}
\quad a

\end{document}
