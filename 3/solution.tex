\documentclass{article}
\usepackage{mathtools}
\usepackage{harpoon}
\usepackage{amsfonts}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

\makeatletter
\newcommand{\tpmod}[1]{{\@displayfalse\pmod{#1}}}
\makeatother

\begin{document}
\title{Introduction to Modern Cryptography - EX. 3}
\author{Roi Koren 305428369\\ Noam Koren 204175004}
\date{\today}
\pagenumbering{gobble}
\maketitle
\newpage
\pagenumbering{roman}

\section{}
\begin{paragraph}
	a Let $m=p\cdot q$ where $p,q$ are primes, and let $e$ be a 
	positive integer that is co-prime to $\varphi(m)$.
	Since $e$ is co-prime to $\varphi(m)$ - $gcd(e, \varphi(m)) = k \neq 1$.
	$\Rightarrow e = a\cdot k, \varphi(m) = b\cdot k$. It follows that Factoring
	some generator $g$ of $\mathbb{Z}^*_m$ - 
	\begin{align*}
		x = g^b&, y = g^{2b}\\
		x^e = g^{be} = g^{akb} &= (g^{bk})^a = 1^a = 1 \\
		y^e = g^{2be} = g^{2akb} &= (g^{bk})^{2a} = 1^a = 1
	\end{align*}
	Hence $x^e \mod m$ from $\mathbb{Z}^*_m$ to $\mathbb{Z}^*_m$ is not one-to-one.
\end{paragraph}

\begin{paragraph}
	b By Lagrange's theorem the order of an element $g$ of a group $G$
	must divide the size of the group - $order(g)| |G|$. For $\mathbb{Z}^*_p$,
	where p is prime we get that $order(g) | \varphi(p)(=p-1)$.
	Given that $p-1 =\prod_i{q_i^{e^i}}$, where $q_i$ are primes. One can
	check if a given $g$ is a generator of $\mathbb{Z}^*_p$ as follows - 

	\begin{algorithm}
	\begin{algorithmic}[]
		\State $\text{is\_generator}( \textit{g} ):$
		\For{\texttt{$q_i$ in $divisors$}}
			\If {$q_i^{\frac{p-1}{q_i}}= 1 \tpmod p$} \Return false
			\EndIf
		  \EndFor
		\State \Return true
	\end{algorithmic}
	\end{algorithm}

	$p-1$ can have at most $log(p)$ divisors, each iteration of the for-loop
	takes $\mathcal{O}(log(p))$ for division and exponentiation. Overall the algorithm's
	running time of $\mathcal{O}(log^2(p))$. \\

	Proof of correctness: $g$ is a generator of $\mathbb{Z}^*_p$ if $order(g) = p -1$.
	Then for each $e_i < p - 1$, $g^{e_i} = g^{\frac{p-1}{q_i}} \neq 1 \tpmod p$. And the 
	algorithm will return true correctly.

	If $g$ is not a generator of $\mathbb{Z}^*_p$, we know that $\varphi(g) = n$
	where $n|p - 1$.

\end{paragraph}

\section{Euler's function}
\begin{paragraph}
	a
\end{paragraph}

\section{El-Gamal under BDDH}
\begin{paragraph}
	a El-Gamal doesn't achieve ciphertext indistinguishability. An adversary
	may choose two messages $(m_1, m_2) = (1, m')$.
	The adversary can then calculate for the received ciphertext $E = (B,C)$ - \\
	\begin{align*}
		&x_1 = ALG(A, B) = ALG(g^a, g^b) = h^{ab} \\
		&x_2 = ALG(g, C) = ALG(g, g^{ab}\cdot m) = 
		\begin{cases}
			h^{ab}, \mbox{ for } m' = 1 \\
			ALG(g, g^{ab}\cdot m), \mbox{ for } m' = m
		\end{cases}
	\end{align*}

	The adversary will then return $b = 0$ if $x_1 = x_2$, and otherwise $b = 1$,
	with $\Pr[b' = b] = 1$.
\end{paragraph}

\begin{paragraph}
	b The key exchange works as follows: \\
	Alice sends a message $A = g^a$. Bob sends a message $B = g^b$. Charlie
	sends a message $C = g^c$.\\
	Based on $a, B, C$ Alice computes $K = (ALG(B, C))^a = (ALG(g^b, g^c))^a
	 = (h^{bc})^a = h^{abc}$. Similarly, Bob computes $K = (ALG(A,C))^b
	  = h^{abc}$ and Charlie computes $K = (ALG(A,B))^c = h^{abc}$. \\
	An adversary sniffing the communicating parties can learn $(g^a, g^b, g^c)$.
	Under BDDH, that triplet together with the private key $(g^a, g^b, g^c, h^{abc})$
	indistinguishable from $(g^a, g^b, g^c, h^d)$, meaning an adversary
	can't distinguish between $K$ and a random element $h^d$ in the
	key space $H$.

\end{paragraph}

\section{Random self reducibility of DLOG}
\begin{paragraph}
	a 
\end{paragraph}

\section{Recovering RSA's private-key is as hard as Factoring}
\begin{paragraph}
	a Given $m,e,d$, we'll find $k$ such that $k = \varphi(m)\cdot l$, where
	$l$ is an odd integer. Notice that - 
	\begin{align*}
		e\cdot d = 1&\tpmod {\varphi(m)} \Rightarrow \\
		e\cdot d = 1 &+ C\varphi(m) \\
		e\cdot d - 1 &= C(p-1)(q-1) = C\cdot 2a \cdot 2b = C\cdot 4ab
	\end{align*}
	Where we used that $p - 1 = 2a$, $q - 1 = 2b$, where $a, b$ are odd integers.
	Since $\varphi(m)$ is even, $C\cdot \varphi(m)$ is also even. To calculate $k$,
	we'll divide $ed-1$ by two, until receiving an odd number $k'$. Since $\varphi(m)/4$ is odd,
	returning $k = 4k'$, we get the required number.
\end{paragraph}

\begin{paragraph}
	b Given an element $g \in \mathbb{Z}^*_m$ with an even order in $g \in \mathbb{Z}^*_p$
	and an odd order in $g \in \mathbb{Z}^*_q$, and $k$ from section a, one can find
	a non trivial square root of 1.
	For $h = k/4$ (h is odd) - 
	\begin{align*}
		g^{2h} = g^{2Cab} = (g^{2a})^{Cb} = (g^{p-1})^{Cb} = 1\tpmod p \\
		g^{2h} = g^{2Cab} = (g^{2b})^{Ca} = (g^{q-1})^{Ca} = 1\tpmod q
	\end{align*}
	From the chinese remainder theorem we get that - $g^{2h} = 1\tpmod{pq}$. \\
	Since $g^{2h} = 1 \tpmod p \rightarrow g^h = \pm1\tpmod p$ and $h$ is odd and
	$g$'s order is odd in $\mathbb{Z}^*_p$,	we know that it must be that $g^h = -1 \tpmod p$.
	Similarly we get that $g^h = 1 \tpmod q$. Combining these, it follows
	that $g^h$ is a non-trivial square root of 1 in $\mathbb{Z}^*_m$.
\end{paragraph}

\begin{paragraph}
	c We first prove that $\frac{1}{2}$ of the elements of $\mathbb{Z}^*_p$ are
	of an even order. \\
	If $p$ is a prime, then $\varphi(p) = p - 1 = 2a$. For some element $d$
	such that $d|p-1$ the number of elements of order $d$ is $\varphi(d)$.
	If $d$ is even, then for $c$ s.t. $d = 2c$ we get from $q2.b$ that
	$\varphi(d) = \varphi(2c) = \varphi(2)\varphi(c) = \varphi(c)$.
	If $d$ is odd, from Lagrange's theorem we get that $d|a$. Also for $c = 2d$,
	$c|a$ and again $\varphi(d) = \varphi(c)$, concluding that the number
	even-ordered elements is the same as the number of odd-ordered elements.
	Since $\mathbb{Z}^*_p \times \mathbb{Z}^*_q \rightarrow \mathbb{Z}^*_{pq}$
	is an isomorphism, a $\frac{1}{4}$ of all elements satisfy the condition.
\end{paragraph}

\begin{paragraph}
	d The factoring algorithm:
	\begin{algorithm}
		\begin{algorithmic}[1]
			\State $k \gets Cab$ where $C$ is odd
			\For{\texttt{$i$ in $1..t$}}
				\State Choose a random $g \gets \mathbb{Z}^*_m$
				\If {$gcd(g,m) \neq 1$} \Return $(p, q) = (g, \frac{m}{g})$
				\EndIf
				\If {$g^k = \pm 1\tpmod m$} continue
				\EndIf
				\State $p \gets gcd(g^k + 1, m)$ \Return $(p, \frac{m}{p})$
			\EndFor
		\end{algorithmic}
	\end{algorithm}

	In step 1, we pick a $k$ based on section $a$. In step 3, with a 
	probability of ${\frac{1}{2}}$ we get a $g$ that satisfies section $b$, 
	i.e. one that is of an even order in $\mathbb{Z}^*_p$ and of an odd
	order in $\mathbb{Z}^*_q$, or vice-versa. If $g$ isn't co-prime to $m$,
	then it is either $p$ or $q$, and we return	so in step 4.
	In step 5 we check whether $g$ is a trivial square root, if it isn't, we
	continue to step 6. From section $b$ we know that $g$ must be a non-trivial
	square root, meaning either $g^k = 1 \tpmod p$ or $g^k = 1 \tpmod q$ and
	in that case we calculate $gcd(g^k + 1, m)$ which will be either $p$ or $q$,
	accordingly. \\

	The probability of finding a correct $g$ in each iteration is $\frac{1}{2}$,
	after $t$ iterations the probability is $1 - 2^{-t}$ with a time complexity
	of $\mathcal{O}(t\cdot poly(n))$.
\end{paragraph}

\section{RSA with shared modulus}
\begin{paragraph}
	a 
\end{paragraph}

\end{document}
