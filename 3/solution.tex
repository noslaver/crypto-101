\documentclass{article}
\usepackage{mathtools}
\usepackage{harpoon}
\usepackage{amsfonts}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

\makeatletter
\newcommand{\tpmod}[1]{{\@displayfalse\pmod{#1}}}
\makeatother

\begin{document}
\title{Introduction to Modern Cryptography - EX. 3}
\author{Roi Koren 305428369\\ Noam Koren 204175004}
\date{\today}
\pagenumbering{gobble}
\maketitle
\newpage
\pagenumbering{roman}

\section{}
\begin{paragraph}
	a Let $m=p\cdot q$ where $p,q$ are primes, and let $e$ be a 
	positive integer that is co-prime to $\varphi(m)$.
	Since $e$ is co-prime to $\varphi(m)$ - $gcd(e, \varphi(m)) = k \neq 1$.
	$\Rightarrow e = a\cdot k, \varphi(m) = b\cdot k$. It follows that Factoring
	some generator $g$ of $\mathbb{Z}^*_m$ - 
	\begin{align*}
		x = g^b&, y = g^{2b}\\
		x^e = g^{be} = g^{akb} &= (g^{bk})^a = 1^a = 1 \\
		y^e = g^{2be} = g^{2akb} &= (g^{bk})^{2a} = 1^a = 1
	\end{align*}
	Hence $x^e \mod m$ from $\mathbb{Z}^*_m$ to $\mathbb{Z}^*_m$ is not one-to-one.
\end{paragraph}

\begin{paragraph}
	b By Lagrange's theorem the order of an element $g$ of a group $G$
	must divide the size of the group - $order(g)| |G|$. For $\mathbb{Z}^*_p$,
	where p is prime we get that $order(g) | \varphi(p)(=p-1)$.
	Given that $p-1 =\prod_i{q_i^{e^i}}$, where $q_i$ are primes. When can
	check if a given $g$ is a generator of $\mathbb{Z}^*_p$ as follows - 

	\begin{algorithm}
	\begin{algorithmic}[1]
		\State $\text{is\_generator}( \textit{g} ):$
		\For{\texttt{$q_i$ in $divisors$}}
			\If {$q_i^{\frac{p-1}{q_i}}=_p 1$} \Return false
			\EndIf
		  \EndFor
		\State \Return true
	\end{algorithmic}
	\end{algorithm}

	$p-1$ can have at most $log(p)$ divisors, each iteration of the for-loop
	takes $\mathcal{O}(log(p))$ for division and exponentiation. Overall we achieve
	a running time of $\mathcal{O}(log^2(p))$.

	Proof of correctness: $g$ is a generator of $\mathbb{Z}^*_p$ if $order(g) = p -1$.
	Then for each $e_i < p - 1$, $g^{e_i} = g^{\frac{p-1}{q_i}} \neq_p 1$. And the 
	algorithm will return true correctly.

	If $g$ is not a generator of $\mathbb{Z}^*_p$.

\end{paragraph}

\section{Euler's function}
\begin{paragraph}
	a
\end{paragraph}

\section{El-Gamal under BDDH}
\begin{paragraph}
	a 
\end{paragraph}

\section{Random self reducibility of DLOG}
\begin{paragraph}
	a 
\end{paragraph}

\section{Recovering RSA's private-key is as hard as Factoring}
\begin{paragraph}
	a Given $m,e,d$, we'll find $k$ such that $k = \varphi(m)\cdot l$, where
	$l$ is an odd integer. Notice that - 
	\begin{align*}
		e\cdot d = 1&\tpmod {\varphi(m)} \Rightarrow \\
		e\cdot d = 1 &+ C\varphi(m) \\
		e\cdot d - 1 &= C(p-1)(q-1) = C\cdot 2a \cdot 2b = C\cdot 4ab
	\end{align*}
	Where we used that $p - 1 = 2a$, $q - 1 = 2b$, where $a, b$ are odd integers.
	Since $\varphi(m)$ is even, $C\cdot \varphi(m)$ is also even. To calculate $k$,
	we first divide $ed - 1$ by 4. If the result is odd, than it follows that $C$
	must be odd - $(ed - 1) / 4 = Cab$, and in that case we'll return $k = ed - 1 = C\varphi(m)$.
	Otherwise, we'll keep dividing $ed-1$ by two, until reaching an odd number, getting
	$\frac{C\cdot 4ab}{2^n}$, and again we get $l = C/2^n$ must be odd, so
	we can return $k = \frac{ed - 1}{2^n}$.
\end{paragraph}

\begin{paragraph}
	b 
\end{paragraph}

\section{RSA with shared modulus}
\begin{paragraph}
	a 
\end{paragraph}

\end{document}
